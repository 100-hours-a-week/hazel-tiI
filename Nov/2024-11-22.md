## 날짜: 2024-11-22

## [리눅스]

### AWS EC2 ubuntu 서버 실행 후 스크립트 띄우기 

1. `AWS EC2`에 접속해 새 인스턴스를 `ubuntu`로 생성한다.
2. 서버를 선택 후 사용자 이름을 `ubuntu`로 하여 접속한다. 
3. `vim`으로 파일을 생성해 실행한다. 
```bash
vim ~/filename.sh
```
4. `vim editor` 창에 원하는 내용을 작성한 뒤 저장 후 종료한다. 
5. 저장한 파일에 실행 권한을 부여하여 실행한다. 
```bash
chmod +x ~/filename.sh
ls -l ~/filename.sh
```

<br>

---

<br>

### vim 알아보기 
#### vim 모드 
- 명령모드 : `vim` 실행 후 바로 시작되는 모드로 커서 이동, 수정, 삭제, 복사, 붙여넣기, 탐색을 수행함
- 입력모드 : 글자를 입력하는 문서를 만드는 모드로 실행 시 `INSERT`가 화면 아래에 표기됨

#### vim 주요 cheat
- `:w` 저장
- `:q` 종료
- `:q!` 저장 없이 종료
- `:e filename` filename 열기 
- `:new` 새파일 
- `:%s/x/y/g` 파일 전체에서 x를 y로 교체
 
<br>

---

<br>

### 리눅스 명령어 체계 
1. 명령어 
> command [options] [arguments]
- command : 실행하려는 명령어
- options : 명령의 동작을 제어하는 값 (없어도 됨)
- arguments : 명령어가 처리할 대상으로 파일 또는 디렉토리 이름 

2. 자주 쓰이는 명령
```bash
mkdir my_directory   # my_directory 생성
cd my_directory      # my_directory로 이동
touch my_file.txt    # my_file.txt 파일 생성
echo "Hello, Unix!" > my_file.txt  # 파일에 내용 쓰기
cat my_file.txt      # 파일 내용 확인
ls -alh .            # 입력한 위치의 파일 목록 출력 
rm file.txt          # file.txt 파일 삭제 
```

3. man 명령
> 프로그램의 메뉴얼을 볼 수 있는 프로그램
```bash
man ls #ls 명령어의 메뉴얼 페이지를 보여줌 
man -k keyword # keyword가 포함된 메뉴얼 페이지를 보여줌
```

4. 하이픈(-) long 타입과 short 타입 
> --tomato -t 하면 토마토의 쇼트 타입이 -t가 되는거임 

- 시스템 정보/관리 명령어
  - `htop` : 실시간으로 시스템 상태 및 프로세스 정보 출력 
  - `df -h` : 파일 시스템의 디스크 사용량을 읽기 좋은 형태로 출력 
  - `du` : 현재 디렉터리의 디스크 사용량 출력
  - `du -sh *` : 현재 폴더 기준 각 파일 및 디렉터리의 총 사용량 요약 출력
  - `sudo du -h --max-depth=1 /` :  `/`를 기준으로 1 depth 기준으로 사이즈 확인 (/var : 1depth, /var/log : 2depth)

- 네트워크 관련 명령어 
  - `ping google.com` : google.com에 패킷을 보내 네트워크 연결 상태 확인
  - `ifconfig` : 네트워크 인터페이스 정보 출력. IP 정보를 확인할 수 있다.     
  - `curl ifconfig.me` : curl: HTTP 요청을 할 수 있는 프로그램이며 "ifconfig.me" 라는 사이트에 요청을 보내면 현재 IP만 응답 받을 수 있다. 
  - `netstat -tnlp` : 현재 열려 있는 포트 및 리스닝 상태 출력
  - `ssh user@remote_host` : 원격 호스트에 SSH로 접속
  - `ssh -i /pemkey/path/key.pem` : private 키를 이용한 접속을 할 때에는 -i 옵션을 사용해서 접속한다. 


<br>

### 리눅스 파일 시스템 
- 파일과 디렉토리로 구성
  - 파일 : 데이터를 저장하는 기본 단위 
  - 디렉토리 : 파일 및 다른 디렉토리를 포함하는 컨테이너 

- 절대경로, 상대경로
  - 절대경로 : `/` 루트 디렉토리를 기준으로 파일이나 디렉토리의 전체 경로를 나타냄
  > /home/user/doc/file.txt
  - 상대경로 : 현재 작업 중인 디렉토리를 기준으로 파일이나 디렉토리의 경로를 나타냄 
  > doc/file.txt



<br>


### sudo 명령 
> 관리자(루트) 권한으로 실행시킬 수 있도록 해주는 명령
```bash
sudo [options] <command>
```
- options : `sudo` 동작을 변경할 옵션
- command : 관리자 권한으로 실행시킬 명령어 

### sudo와 su의 차이
`sudo`는 관리자의 권한을 받는 것이지 관리자가 되는 것이 아님
`su`가 관리자로 전환하는 명령 -> 모든 명령 실행 가능 
 

<br>


### PATH 변수 
> 명령을 입력하면 시스템이 `PATH` 변수에 저장된 디렉토리 목록을 순차적으로 검색해서 해당 명령어의 실행 파일을 찾음 
```bash
echo $PATH
# /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
``` 

- `:` 콜론은 구분자로, 콜론을 기준으로 스플릿 됨 
- 편의성, 안전성, 우선순위를 위해 사용됨 

<br>


### 리눅스 파이프 
> 한 명령어의 출력을 다른 명령어의 입력으로 전달하는 기능 
```bash
# command1 출력을 command2 입력으로 전달하기 
command1 | command2 
``` 
- 파일 내용 검색/필터링할 때 사용 
- 명령어 출력에서 특정 정보 추출할 때 사용  


<br>


### 리눅스의 출력 연산자 > / >>
- `>` 연산자 : 텍스트 파일에 작성하고 기존 파일이 존재하면 덮어씀 
```bash
echo "hello word" > intro.txt
```
- `>>` 연산자 : 텍스트 파일에 `append` 하는 개념으로 기존 파일에 추가됨 
```bash
echo "hello word" >> intro.txt
```


<br>


### 성능 모니터링 
> 시스템의 효율성과 안정성을 유지하기 위해 시스템 리소스 사용률, 응답 시간, 처리량 등 다양한 지표를 모니터링 함 
- 서버의 성능 관찰
- 어플리케이션 성능 관찰 

### 성능 모니터링을 하는 이유
1. 서비스 가용성 확보 
2. 성능 최적화 
3. 트래픽 관리 
4. 사용자 경험 향상 
5. 문제 원인 분석 
6. 비용 절감 


<br>


### permission 에러 났을 때 확인 
> syslog, kern.log


### 셸 스크립트 
- 셸 : 운영체제에서 사용자와 커널 사이의 인터페이스 역할하는 프로그램 
> 셸에서 실행할 명령어를 텍스트 파일에 작성한 스크립트 


<br>


## CI/CD : 지속적 통합, 지속적 배포 
> 제품을 빠르게 출시할 수 있도록 도와주는 방법론 
- 코드 커밋 부터 배포까지 개발 프로세스를 자동화 

### CI : 지속적 통합
- 팀원들 각자의 코드를 정기적으로 통합하면서 문제를 빠르게 발견하고 테스트를 자동으로 할 수 있게 만드는 것 
- 빌드 자동화, 테스트, 개발자 코드 공유 저장소 병합을 포함  
- 목표 : 소스 코드를 효율적으로 공유 저장소에 통합하는 것 


<br>


### CI 수행 도구 
- 버전 관리, 공유 저장소 : Github
- 빌드, 테스트 관리 : jenkins 
- gradle(java) webpack(js)

### CI 장점 
- 머지 컨플릭 방지 : 개별 개발자 시스템과 공유 저장소 간의 소스 코드를 자주 동기화 해서 병합 충돌 완화
- 코드 리뷰 간소화 : 빈번한 협업으로 프로세스가 간소화 돼서 수동 리뷰 개입 필요성이 줄어듦 
- 개발 프로세스 가속화 : 협업을 통해 소스 코드의 통합을 촉진해서 개발 프로세스 향상됨
- 즉시 테스트 가능한 빌드 : 최신 상태이고 사용 준비가 된 빌드를 갖게 됨 -> 컴파일 보장, 최신 업데이트 포함
- 프로젝트 백로그 감소 : 공유 저장소에 변경 사항을 자주 구현해서 보류 중인 작업이 지속적으로 처리 되고 백로그가 줄어듦 


<br>


### Continuous Deployment(CD) vs Continuous Delivery(CD)

| 구분                     | Continuous Deployment (CD)                                                       | Continuous Delivery (CD)                                                        |
|--------------------------|----------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
| 정의                     | 코드 변경사항이 자동으로 프로덕션 환경까지 배포됨                                    | 코드가 자동으로 준비되지만, 프로덕션 환경 배포는 수동으로 이루어짐                      |
| 목적                     | 배포 과정 완전 자동화, 신속한 피드백 루프 형성                                           | 배포 자동화와 안정성 중시, 수동 배포로 신뢰성 있는 배포 제공                             |
| 요구사항                 | 강력한 자동화 테스트, 배포 실패 시 빠른 복구 시스템 필요                                | 충분한 테스트 커버리지, 수동 검토 및 승인 절차 필요                                   |
| 장점                     | 신속한 업데이트와 사용자 피드백 반영, 반복적인 배포로 코드 품질 개선                       | 안정성 높은 배포와 비즈니스 요구에 맞춘 릴리스 가능                                    |
| 단점                     | 잘못된 코드 배포 가능성 증가, 신뢰성 높은 테스트 인프라가 필요                             | 프로덕션 환경 반영까지 추가 시간이 소요됨                                             |



### CD(Continuous Deployment) : 지속적 배포 
> CI/CD 파이프라인에서 CI 다음 단계로 테스트를 통과한 모든 코드 변경 사항을 프로덕션에 자동으로 배포하는 것 

### CD(Continuous Delivery) : 지속적 딜리버리 
> 코드가 항상 운영 환경으로 배포가 가능한 상태로 준비 된 것


<br>



### CD 수행 도구 
- Github
- ArgoCD, Kubernaetes


<br>


### 배포 전략
| 배포 전략      | 설명                                                                                      | 장점                                         | 단점                                          |
|----------------|-----------------------------------------------------------------------------------------|----------------------------------------------|-----------------------------------------------|
| 빅뱅 배포      | 모든 변경사항을 한 번에 배포하는 방식으로, 준비와 테스트가 필수적이며 롤백이 어려움                               | MVP 개발에 적합, 단순한 배포 과정              | 문제 발생 시 전체 시스템에 영향, 롤백 어려움      |
| 롤링 배포      | 무중단 배포가 가능하며 순차적으로 서버에 새로운 버전을 배포하여 점진적으로 배포됨                           | 무중단 배포 가능                              | 특정 유저가 잘못된 버전을 받을 수 있음            |
| 블루그린 배포  | 기존의 블루 서버와 새로운 그린 서버를 동시에 운영하며, 트래픽을 그린 서버로 전환해 무중단 배포를 실현              | 무중단 배포 가능, 안정적인 전환               | 높은 비용 발생 (서버 이중화 필요)                 |
| 카나리 배포    | 일부 트래픽만 새로운 버전으로 유도하여 성능 및 안정성을 검증하는 방식                                    | 문제 발생 시 빠른 대응 가능                    | 복잡한 트래픽 관리, 세밀한 모니터링 필요            |


<br>

### 오늘의 회고 
- EC2에서 우분투 서버를 설정하고 스크립트를 실행하는 실습을 진행하였다. 에디터 사용법이 어색해서 아직은 연습이 많이 필요할 것 같다. 교재의 내용을 따라가다 보면 명령이 익숙해질 것 같다. 오늘 좋았던 점은 모호했던 CI/CD 파이프라인에 대한 이해가 깊어진 점이었다. 이후 실습에서 이를 적용할 순간이 기대됐다. 복습할 양이 많지만 오늘을 대비해 과제를 목표한 분량까지 끝내놨기 때문에 주말엔 배운 내용 복습을 진행 할 예정이다.  



<br>