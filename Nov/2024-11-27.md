## 날짜: 2024-11-27

## 딥다이브 

### 🤔 Linux permission이란?

👉 파일 또는 디렉토리에 대해 r (읽기), w (쓰기), x (실행) 권한을 부여하는 것

---

### 파일 정보 표시 구조
<img src="/img/linux1.png"/>
1. 파일 타입: `d`는 디렉토리를 의미
2. 권한 정보 (access mode)
3. 링크 수
4. 소유자
5. 소유 그룹
6. 파일 크기
7. 생성 날짜
8. 파일 이름

---

### 📕 Permission 종류

- r: 읽기 권한  
- w: 쓰기 권한  
- x: 실행 권한  

---

### 파일 실행 권한의 개념

- 실행 권한은 해당 파일을 실행할 수 있는지 결정하는 정보이다.  
- 실행 권한이 없는 사용자가 실행하려고 하면 **Permission denied** 오류가 발생한다.  

- 단, 실행 권한 없이도 `/bin/bash 파일명` 명령으로 파일 내용을 읽어 실행 가능하다.  
- 하지만 `./파일명`으로 바로 실행하려면 실행 권한이 필요하다.

---

### 📕 권한 정보 분석하기

- 권한 정보는 3자리 단위로 분석한다.
- **소유자 / 그룹 사용자 / 기타 사용자**의 접근 권한으로 나뉜다.

<br>

<img src="/img/linux2.png" height="70px" width="300px"/>

#### 권한 정보
1. 소유자: r (읽기), w (쓰기), x (실행) 허용  
2. 그룹 사용자: r (읽기), x (실행) 허용  
3. 기타 사용자: r (읽기), x (실행) 허용  

---

### 📕 권한 정보 변경하기: `chmod`

#### 1️⃣ 기호 방식 (Symbolic Mode)  
`chmod [대상] [+/-] [권한] [파일/디렉토리명]`
| Reference  | Class  | 설명        |
|:----------:|:------:|:---------:|
| u          | user   | 파일 소유자    |
| g          | group  | 파일 그룹의 멤버 |
| o          | others | 기타 사용자    |
| a          | all    | 모든 사용자    |

```bash
chmod o-r a.txt  # 기타 사용자의 읽기 권한 제거
chmod o+r a.txt  # 기타 사용자의 읽기 권한 추가
chmod o+w a.txt  # 기타 사용자의 쓰기 권한 추가
chmod o-w a.txt  # 기타 사용자의 쓰기 권한 제거
```

<br>

#### 2️⃣ 8진수 방식 (Octal Mode)
`chmod [권한 값] [파일/디렉토리명]`

권한 값 정의:3자리 비트 값 
- r = 4
- w = 2
- x = 1
- 예: rwx = 4 + 2 + 1 = 7

```bash
chmod 755 test.txt  # test.txt에 rwxr-xr-x 권한 부여 
```

---


### 📕 디렉토리 소유권 변경하기: `chown`

- **명령어**: `chown` (change owner)  
```bash
chown [옵션] [변경 할 유저명:변경할 그룹명] [파일 및 디렉토리명]
```

- **예제**
```bash
  chown user1 test.txt  # test.txt 파일 소유자를 user1로 변경
  chown :user2 test.txt # test.txt 파일 그룹명을 user2로 변경
  chown user1:user2 test.txt # 소유자는 user1, 그룹명은 user2로 변경
  chown -R user1:user2 test.txt # 하위 폴더/파일까지 변경 (-R 옵션)
```

---

### 🤔 접근 통제란?
👉 운영체제에서 접근 통제는 파일, 디렉토리, 네트워크 소켓 등 시스템 자원에 대한 접근 권한을 관리하고 제한하는 것을 의미함
-> 특정 사용자나 프로그램이 자원을 사용하려 할 때 적절한 권한이 있는지 확인 후 허용/거부를 결정함

---

### 📕 접근 통제 방법
#### 1️⃣ DAC (Discretionary Access Control)
- 사용자와 그룹을 기반으로 접근 제한  
- 파일 소유자가 직접 다른 사용자에게 접근 권한을 부여하거나 제한 가능  
- 예: chmod 명령어를 사용해 읽기/쓰기/실행 권한을 설정  
- **임의적**: 소유자의 판단에 따라 자유롭게 권한을 조정할 수 있음  

<br>

#### 2️⃣ MAC (Mandatory Access Control)
- 미리 정의된 보안 정책과 등급에 따라 접근 제한  
- 사용자/프로그램의 보안 등급과 객체(파일, 디렉토리 등)의 보안 레벨이 기준  
- 소유자라도 자신의 파일 권한을 임의로 변경할 수 없음  
- 관리자만 권한 설정 가능  

---

### 🤔 AppArmor(Application Armor)란?
- 리눅스 시스템에서 MAC을 구현하는 보안 모듈  
- 프로그램/프로세스가 시스템 자원에 접근하는 방식을 제어하고 제한하는 데 사용됨  

<br>

#### AppArmor의 특징
1. 프로필 기반 접근 통제  
   - 애플리케이션 별로 프로필을 설정해 접근 가능한 파일, 디렉토리, 네트워크 자원을 정의함  
2. 정책 유연성  
   - 강제적 제어 기반이지만 사용자가 설정한 규칙을 우선 적용  
   - 특정 애플리케이션만 제어하거나, 시스템 전체를 대상으로 설정 가능  
3. 로그 및 알림  
   - 허용되지 않은 접근 시도가 발생하면 로그 기록과 관리자 알림 기능 제공  

<br>

#### 강제적 정책과 운영 효율성의 조화
- AppArmor는 MAC 기반 강제 보안 정책을 따르면서도, 설정 간소화와 유연성을 제공함  
- 적용 범위 선택, 테스트 모드 제공 등을 통해 운영 효율성을 높임  

---

### 오늘의 회고 
- 배운점 : 리눅스 퍼미션에 대해 조사하고 시연 준비를 위한 실습을 하며 리눅스 파일/디렉토리의 소유권과 권한을 제어하는
방법을 익힐 수 있었다. 또 어렵게 느껴졌던 AppArmor를 좀 더 포괄적인 개념인 MAC, DAC를 이해하고 나니 이해하기가 수월했다. 
- 아쉬운 점 : 자료를 찾아보니 AppArmor가 MAC를 구현한 보안 모듈이라고 나와있었는데 MAC는 강제적 접근 통제 방식이라 유연성이 허용되지 않을 것 같은데 또 AppArmor는 유연성을 중시한다고 하는 점이 잘 이해가 되지 않았다. 이후 추가적인 공부를 했지만 아직까지 개념이 모호하다. 실습을 통해 구조와 동작 원리를 확인하지 않아서 생긴 모호함일 수도 있겠다고 느꼈다. 

<br>