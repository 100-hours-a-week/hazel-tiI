## 날짜: 2024-12-12

## 커뮤니티 과제 

### model 분리 
- `express`에서 `models`와 `controllers`를 분리해서 코드의 구조화 및 유지보수성을 높이기 위한 작업 
- `MVC` 아키텍처를 구현해서 코드의 역할 및 책임을 명확하게 함 
#### models
- 데이터와 관련된 작업을 담당함 
- 데이터베이스 스키마 정의 : 테이블 구조 및 필드에 대한 제약 조건 설정 
- 데이터베이스 쿼리 로직 : 데이터 조회, 삽입, 수정, 삭제 작업 처리 
- 데이터 검증 및 변환 : 데이터베이스에 저장하기 전에 검증하거나 필요한 경우 변환 작업 수행
#### controllers
- 비지니스 로직 및 `HTTP Request` 처리 역할
- 필요한 데이터를 models에서 가져오거나 저장 
- 요청 처리 후 응답 반환 및 예외처리 
- `controllers`는 데이터베이스와 직접적으로 상호작용하지 않고 `models`를 호출하여 필요한 작업을 수행함

<br>

### 트랜잭션 
- 데이터를 처리할 때 안정성을 확보하기 위한 방법으로 여러 데이터 처리 작업을 하나의 논리적인 작업 단위로 묶어주는 기능 
- 데이터 처리 중 하나라도 실패할 경우 롤백을 통해 모든 작업을 이전 상태로 복구함 
- 데이터의 일관성 및 무결성을 유지하기 위해서 사용함 
#### 도입의 필요성 
- 예를 들어 한 테이블에서 데이터가 성공적으로 삭제 되었지만, 다른 테이블에서 삭제 작업이 실패할 경우 데이터 불일치 문제가 발생할 수 있음
- 트랜잭션을 사용하면 이러한 상황을 방지하고 예상치 못한 오류로부터 데이터베이스의 안정성을 확보할 수 있음 
#### 구현 방식 
- `beginTransaction`을 통해 트랜잭션을 시작하고 시작 단계에서 에러가 발생하면 `Promise`의 `reject`를 통해 에러를 반환함 
- 여러 `SQL` 쿼리를 순차적으로 실행하고 하나라도 실패할 경우 `catch` 블록에서 `rollback`을 호출해 이전 상태로 복구함 
- 모든 작업이 성공적으로 완료될 경우 `commit`을 호출해서 해당 변경 사항을 확정함 

<br>


### DAO(Data Access Object)
- 과제 진행 상황을 팀과 공유하던 중 Json 기반 데이터 처리 로직을 데이터베이스 기반으로 리팩토링 하는 방법에 대한 얘기를 했다. 
그 중 DAO를 적용하는 방식을 제안 받았는데 이 부분을 조금 정리해 보고자 한다. 
- DAO 방식은 데이터베이스 관련 로직을 별도의 객체로 캡슐화 해서 데이터 계층의 변경이 애플리케이션 전반에 영향을 주지 않도록 설계가 가능한  디자인 패턴이다. 특히, 인터페이스와 구현체를 분리해서 응집도를 높이고 의존성을 낮추는 것이 중요하다. 
- 기존 방식은 데이터베이스 변경 시 전체 로직을 수정해야 했다. 그런데 DAO 방식을 사용하면 DAO를 통해 CRUD 로직을 구현하고 저장소를 전환할 때 수정해야 할 코드의 범위를 줄일 수 있다. 
- 데이터베이스를 구현할 때 의존성을 최소화하는 것이 중요한 것은 알고 있었지만 단순히 코드 분리와 리팩토링을 넘어서 애플리케이션 확장성 및 유지보수성을 고려한 아키텍처 설계가 왜 필요한지 깨달을 수 있었다. 처음 코드를 설계할 때 아키텍처를 고려하지 않으면 리팩토링 과정에서 많은 시간이 소모될 수 있음을 실감하게 되었다. 

### 다른 객체 설계 방식 알아보기 
#### DTO (Data Transfer Object)
- 데이터 전송을 위해 만들어진 객체 
- 데이터 계층에서 서비스 계층 또는 API 응답 등의 계층 간 데이터 교환을 담당
- 계층 간 데이터를 전달할 때 데이터를 구조화하여 불필요한 데이터를 제외하고 필요한 정보만 담아 전달함
#### VO (Value Object)
- 특정 값을 명확하게 표현하기 위해 사용하는 객체  
- 엔티티와는 달리 ID가 없으며 값의 비교는 객체의 참조가 아닌 속성의 값을 기준으로 이루어짐
- 불변성을 지키기 때문에 한 번 생성된 객체는 값이 변경되지 않음
- 값 중심 설계를 통해 도메인 모델에서 값의 의미를 명확히 표현할 수 있음
- 데이터 무결성과 안전성을 보장함 


<br>