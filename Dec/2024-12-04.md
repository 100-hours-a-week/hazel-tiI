## 날짜: 2024-12-04

## 딥다이브 : API Gateway

### 🤔 API Gateway란? 
API Gateway란 클라이언트와 백엔드 서비스 간의 통로 역할을 하는 서비스 관리자이다. 
클라이언트의 요청을 받아 적합한 서비스로 전달하고 API를 생성, 유지 관리, 모니터링, 보호하는 다양한 기능을 제공한다. 


<br>

### 📕 API Gateway 특징 
- 중앙 집중화된 요청 관리
    - 클라이언트의 요청을 수집하고 이를 적합한 백엔드 서비스로 전달하는 중계 역할
    - 각 서비스별 엔드포인트 대신 단일 진입점(`Single Entry Point`)을 제공
- 기능 확장성
    - 인증/인가, 요청 변조, 응답 조작, 속도 제한 등의 기능을 플러그인 형태로 제공해서 유연한 확장이 가능함
- 트래픽 최적화
    - 마이크로서비스 환경에서 요청을 통합적으로 관리하고 API 성능과 네트워크 트래픽을 최적화 함
- 프로토콜 변환 및 데이터 조작
    - REST, HTTP, WebSocket 등 다양한 프로토콜 간의 변환을 지원하고 요청과 응답 데이터를 변조하거나 변환할 수 있음



<br>


### 📕 API Gateway 사용 이유 
- 보안  강화
    - 인증, 권한 부여, 요청 제한 등을 통해 API 남용 및 과도한 요청을 방지함
    - `DDoS` 공격과 같은 보안 위협에도 대비할 수 있음
- 효율적인 요청 처리
    - 클라이언트 요청을 적합하게 조합하여 필요한 데이터를 한 번에 제공하기 때문에 API 호출 횟수를 줄이고 응답 속도를 높임
- 운영 비용 절감
    - 요청 처리 및 데이터 전송 단위로 요금이 부과되는 방식이므로 효율적인 비용 관리를 지원함 

<br>


### 📕 API Gateway에서 제공하는 API 유형 
1. HTTP API
- 가장 간단하고 저렴한 옵션
- 주로 데이터 전달용으로 사용
- RESTful API 엔드포인트를 구축하는 데 최적화돼 있음 
- 대부분의 Web API가 HTTP API로 이루어지고 있음 (ex: AWS Lambda와 같은 서버리스 아키텍처)

2. REST API 
- API 키, 요청/응답 변환, 요청 검증 등 고급 기능 지원
- 비용이 비싸고 느림 
- 더 복잡한 API 관리 및 강화된 보안 요구사항을 충족함

3. WebSocket API
- 클라이언트 앱과 백엔드 간의 양방향 통신을 지원함
- 사용자의 브라우저와 서버 사이의 인터액티브 통신 세션을 설정할 수 있게 하는 고급 기술
- 실시간 양방향 통신 애플리케이션을 구축하여 백엔드 서비스와 클라이언트 간의 메시지 전송을 처리하기위해 지속적인 연결을 유지함 (ex: zoom, slack)

<br>



### API Gateway 동작 방식 
1. 클라이언트 요청 수집
- 클라이언트의 모든 요청을 수신하고 이를 하나의 중앙 플랫폼에서 관리
2. 인증 및 검증
- 요청이 API Gateway에 도달하면 **인증 및 권한 검증**을 거침
- 이를 통해 적합한 요청만 백엔드 서비스로 전달되게 됨
3. 트래픽 라우팅 및 데이터 처리
- 요청은 적절한 백엔드 서비스로 라우팅되며 필요 시 요청 데이터를 변조하거나 가공함
4. 모니터링 및 로깅 
- API 호출, 오류율, 지연 시간 등의 데이터를 실시간으로 모니터링하며 로그를 기록함


<br>


### 📕 API Gateway 장점 
- **효율적인 API 개발**
    - 테스트 및 버전 관리가 쉬워지고 반복적인 업데이트가 최소화됨
- **확장성 있는 생산성**
    - 요청 처리량을 효율적으로 관리하고 트래픽 급증 상황에서도 안정적으로 작동함
- **통합 모니터링 및 관리**
    - 요청 데이터를 시각화하여 API 성능과 상태를 실시간으로 파악할 수 있음



<br>


### 📕 API Gateway 단점 
- **복잡한 보안 관리**
    - 마이크로서비스 환경에서는 서비스 간 통신의 보안이 추가적인 과제를 제공함
- **단일 장애점**
    - API Gateway가 중단되면 전체 시스템에 영향을 미칠 수 있음
- **높은 의존성**
    - 마이크로서비스가 추가될 때마다 Gateway를 업데이트해야 하므로 관리가 어려워질 수 있음

<br>



### 👉 API Gateway vs Load Balancer
|            | API Gateway                                                                          | Load Balancer                             |
|:----------:|:------------------------------------------------------------------------------------:|:-----------------------------------------:|
| 기능         | 네트워크 트래픽 관리 및 데이터 변환, 인증 등을 수행하여 클라이언트와 서비스 간 중재 역할 수행                               | 서버 부하를 분산하여 서버의 안정성과 성능을 유지               |
| 데이터 처리 방식  | 클라이언트 요청을 마이크로서비스 아키텍처에서 적합한 엔드포인트로 전달하며 트래픽 관리 외에도 요청 변환, 인증, 권한 부여와 같은 부가적인 기능을 제공 | 트래픽 분산을 위해 단순히 요청을 가장 적합한 서버로 전달          |
| 보안         | 인증, 권한 부여 등 보안 제어 기능 내장                                                              | 자체 보안 기능은 없으며 주로 다른 보안 구성 요소와 함께 사용       |
| 사용 사례      | 마이크로서비스, API 관리 및 인증이 필요한 복잡한 시스템에서 사용                                               | 고정된 트래픽 패턴을 가진 서버 풀에서 트래픽 부하를 관리해야 할 때 사용 |

<br>


### API Gateway vs Load Balancer 정리
- 둘 다 네트워크 트래픽을 관리하고 최적화를 하는데 사용 되는 구성 요소라는 점에서 공통점이 있음
- API Gateway는 주로 API 요청 관리 및 비즈니스 로직 실행에 초점을 맞춤
- Load Balancer는 서버 부하 분산과 안정성 유지에 초점을 맞춤 



<br>

### 오늘의 회고 
- AWS API Gateway 실습을 진행하면서 딥다이브 발표에 내용을 담을 수 있으면 좋겠다고 생각했지만 시간 관계상 못한 점이 아쉽다. 
- 발표 후 API Gateway를 다중화하여 사용하는 경우가 있는지에 대한 질문을 받았는데 제대로 답변하지 못해 아쉬웠다. 이후 보충을 위해 알아본 결과 API Gateway의 SPOF 문제를 대비하여 AWS API Gateway 자체에 이미 다중화 및 고가용성을 제공하기 때문에 일반적으로는 추가적인 다중화가 필요하지 않다는 것을 알게되었다. 생각치 못한 질문이라 다른 관점에서 주제를 바라볼 수 있어 좋았다. 
- 받은 주제에 대해 궁금한 점을 위주로 탐구하는 방식으로 조사를 한 팀원분이 계셨는데 새로운 접근법이었고 개념에 대한 궁금증이 함께 해결되어 유익했다. 이런 다른 시각의 접근은 본받을 만한 점이 많았고 다양한 사람들과의 협업을 통해 항상 배우는 점이 많아 즐겁고 의미 있는 경험이었다.  



<br>

[참고 자료]
- https://docs.aws.amazon.com/ko_kr/apigateway/latest/developerguide/api-gateway-basic-concept.html
- https://www.wallarm.com/what/the-concept-of-an-api-gateway
- https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-API-Gateway-%EA%B0%9C%EB%85%90-%EA%B8%B0%EB%B3%B8-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%A0%95%EB%A6%AC#api_gateway_-_%EC%9A%94%EA%B8%88_%EC%A0%95%EC%B1%85
- https://newsletter.systemdesigncodex.com/p/load-balancers-vs-api-gateways-vs 