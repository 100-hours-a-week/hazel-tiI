## 날짜: 2025-01-03

## 무중단 배포 전략의 종류 

### 롤링, 블루/그린, 카나리 배포 




<br>


### 무중단 배포  
- 기존 방식의 배포에서는 새로운 버전을 배포하기 위해 기존 서비스를 종료하고 새로운 서비스를 시작해야 하며 이로 인해 다운타임이 발생할 수 있습니다. 
- 다운타임 동안 사용자는 서비스를 이용할 수 없으므로 이용의 불편이 발생합니다. 
- 이러한 문제를 해결하기 위해 중단이 없는 배포 방식을 사용하는데 이를 무중단 배포라고 합니다. 


<br>

---

<br>

### 롤링 배포 
- 롤링 배포는 애플리케이션 인스턴스를 순차적으로 교체하여 이전 버전의 애플리케이션을 새로운 버전으로 점진적으로 교체하는 전략으로 무중단 배포의 가장 
기본적인 방식입니다. 
- 인스턴스를 정해놓은 단위로 순차적으로 새로운 버전으로 교체됩니다. 
- 가용 자원이 제한적일 경우 적합한 방식입니다. 
#### 장점 
- 로드 밸런서를 통해 연결된 서버들을 하나씩 새로운 버전으로 변환 시키는 방식으로 추가적인 서버 자원을 사용하지 않아 효율적입니다. 
- 점진적으로 배포하기 때문에 문제가 발생했을 때 롤백이 가능합니다. 
- 관리가 간단하여 적용이 용이합니다. 
#### 단점 
- 새 버전을 배포할 때 인스턴스 수가 감소하기 때문에 트래픽 부하가 증가할 수 있습니다.  
- 기존 버전과 새로운 버전이 동시에 운영되므로 API와 데이터베이스 간의 호환성 문제가 발생할 수 있습니다. 따라서 사전에 철저한 테스트와 호환성 검증이 
필요합니다. 


<br>

---

<br>


### 블루/그린 배포 
- 블루와 그린, 두 개의 독립적인 환경을 사용해 배포하는 전략입니다.
- 현재 운영 중인 블루 환경과 새로운 버전이 배포된 그린 환경으로 구분됩니다. 
- 배포 준비가 완료되면 블루 환경에서 그린 환경으로 트래픽을 단일 스위치 방식으로 전환합니다.  
#### 장점 
- 문제가 발생하면 블루 환경으로 빠르게 전환하여 롤백이 가능합니다.
- 운영 환경을 유지하면서 새로운 버전을 테스트 할 수 있습니다. 
#### 단점 
- 운영 환경을 전환할 때 잠시지만 두 개의 환경이 동시에 실행되는 시간이 있기 때문에 추가적인 서버 비용이 발생합니다. 



<br>

---

<br>


### 카니리 배포 
- 새로운 버전을 모든 사용자에게 릴리즈 하기 전에 일부 사용자에게 먼저 배포하는 전략입니다. 
- 이를 통해 안정성과 성능을 검증합니다. 
- 소수의 사용자 그룹(카나리 그룹)에만 제한적으로 배포하고 피드백과 시스템 메트릭을 모니터링한 다음 문제가 없으면 배포를 확장합니다. 
#### 배포 절차
1. 평가 단계 : 새로운 버전을 제한된 사용자 그룹에 배포
2. 모니터링 단계 : 사용자 피드백 및 시스템 메트릭 모니터링
3. 확장 배포 단계 : 점진적으로 사용자 그룹 확대
4. 전체 배포 단계 : 최종적으로 배포 
#### 장점
- 초기 문제를 빠르게 확인하고 수정할 수 있습니다. 
- 사용자 피드백을 통해 품질을 높일 수 있습니다. 
#### 단점
- 추가 인스턴스 및 정교한 모니터링 도구가 필요하기 때문에 많은 비용이 발생합니다.  
- 여러 버전의 애플리케이션을 동시에 운영해야 하기 때문에 인프라 관리가 복잡합니다.

<br>

---

<br>


### 배포 전략 선택 시 고려사항 
- 애플리케이션의 중요성과 배포 환경에 따라 적합한 전략을 선택해야 합니다. 
  - 테스트 및 개발 환경에서는 단순한 배포 방식을 사용할 수 있지만 프로덕션 환경에서는 무중단 배포 전략을 주로 사용합니다. 
- 서비스의 가용성 수준(SLA)에 따른 무중단 배포의 필요성을 고려해야 합니다.
  - SLA가 높은 서비스일 수록 무중단 배포 선택이 필수적입니다. 
- 미션 크리티컬한 서비스의 경우 블루/그린 또는 카나리 배포 전략을 주로 사용합니다. 
  - 미션 크리티컬한 서비스 : 비지니스나 조직의 주요 목표를 수행하는 데 있어 필수적이고 중단 시 심각한 영향을 미치는 서비스를 의미합니다. 
- 비용 효율성을 고려해 필요한 리소스를 최적화 해야 합니다. 


<br>



### 오늘의 회고
- 오늘은 프로젝트가 배포 단계에 있기 때문에 각 무중단 배포 전략의 특징과 장단점에 대해 정리해보았다. 서비스의 특성에 따라 적합한 배포 전략을 선택하는 것이
중요하다는 것을 다시 한 번 느꼈다. 특히 서비스의 규모, 트래픽 패턴, 비용 등을 종합적으로 고려해서 선택을 해야한다는 점을 명확하게 할 수 있었다. 
- 배포 전략을 단순히 기술적인 관점에서만 바라볼 게 아니라 서비스 운영 관점에서도 생각하도록 습관을 들여야 할 것 같다. 



<br>

[참고]
- https://reference-m1.tistory.com/211
- https://www.harness.io/blog/blue-green-canary-deployment-strategies
- https://velog.io/@hooni_/Blue-Green-%EB%AC%B4%EC%A4%91%EB%8B%A8-%EB%B0%B0%ED%8F%AC
- https://velog.io/@jingrow/%EB%B8%94%EB%A3%A8%EA%B7%B8%EB%A6%B0-%EB%A1%A4%EB%A7%81-%EC%B9%B4%EB%82%98%EB%A6%AC-%EB%B0%B0%ED%8F%AC%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90%EA%B3%BC-%EC%96%B4%EB%96%A4-%EA%B2%BD%EC%9A%B0%EC%97%90-%EA%B0%81%EA%B0%81%EC%9D%98-%EB%B0%B0%ED%8F%AC%EB%B0%A9%EC%8B%9D%EC%9D%84-%EC%8B%9C%EB%8F%84%ED%95%98%EB%8A%94%EC%A7%80-%EC%A1%B0%EC%82%AC%ED%95%B4%EB%B3%B4%EC%84%B8%EC%9A%94