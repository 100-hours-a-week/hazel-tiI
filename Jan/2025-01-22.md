## 날짜: 2025-01-22

## 딥다이브

### 쿠버네티스는 무엇이며 왜 사용하는가? 



<br>

### 들어가기에 앞서 : 용어 정리 

#### 컨테이너
애플리케이션의 실행 환경까지 모두 포함해 독립적으로 프로그램을 실행할 수 있도록 도와주는 기술
이를 통해 환경 간 차이로 인한 문제를 줄이고 격리된 환경에서 실행되기 때문에 이식성이 높음

#### 컨테이너 런타임
컨테이너를 생성, 실행, 관리할 수 있도록 돕는 소프트웨어

#### 도커
가장 많이 사용되는 컨테이너 런타임 컨테이너
이미지를 생성하고 저장소에 공유하거나 여러 환경에서 컨테이너를 쉽게 실행할 수 있도록 도움

#### 쿠버네티스
컨테이너를 자동으로 배포, 관리, 확장, 복구하는 오케스트레이션 도구
도커와 같은 컨테이너 런타임을 사용하여 여러 서버(노드)에 컨테이너를 분산 배치하고, 문제가 생긴 컨테이너를 교체하며, 설정(비밀번호, 환경 변수 등)을 관리함

#### 오케스트레이션
여러 컨테이너를 효과적으로 배포, 관리, 확장, 복구하기 위해 필요한 작업들을 자동화하는 과정
쿠버네티스는 이러한 오케스트레이션을 수행하는 대표적인 도구임

| 용어       | 의미                                            |
|:--------:|:---------------------------------------------:|
| 컨테이너     | 애플리케이션과 그 실행 환경을 포함해 독립적으로 실행할 수 있도록 하는 격리 기술 |
| 컨테이너 런타임 | 컨테이너를 생성, 실행, 관리하는 데 필요한 소프트웨어 도구             |
| 도커       | 가장 널리 사용되는 컨테이너 런타임으로, 컨테이너 이미지 생성 및 공유를 지원   |
| 쿠버네티스    | 컨테이너를 자동으로 배포, 관리, 확장, 복구하는 컨테이너 오케스트레이션 도구   |
| 오케스트레이션  | 여러 서버에 걸쳐 컨테이너를 배치하고, 설정과 관리를 자동화하는 과정        |


<br>


### ✏️ 쿠버네티스의 배경

#### 전통적 배포
기존 전통적인 애플리케이션 배포는 하나의 물리적 서버에 하나의 OS를 설치하고 그 위에 여러 애플리케이션을 실행함
- 다른 OS를 쓰려면 새로운 컴퓨터가 필요
- 여러 애플리케이션이 리소스를 공유하므로 성능 저하

#### 가상화 기술(VM)의 도입
하나의 물리적 컴퓨터를 여러 대의 가상 컴퓨터처럼 나누어 사용함으로써 하나의 서버에서 여러 OS 실행 가능
- VM이 많을 수록 성능이 저하됨
- 애플리케이션 추가 시 새 OS 설치와 환경 설정이 필요

#### 컨테이너 기술의 등장
애플리케이션과 애플리케이션을 실행하는 데 필요한 모든 환경을 한 컨테이너에 포함
- 애플리케이션 간 OS를 공유해 리소스를 효율적으로 사용
- 별도의 OS 설치가 필요 없음

#### 컨테이너 오케스트레이션 도구
컨테이너를 배포하기 위한 일련의 작업들(배포, 관리, 복구 작업)을 자동화 해줌
- 대표적 도구 : 쿠버네티스
    - 구글 Borg를 기반으로 발전한 도구


<br>


### ✏️ 쿠버네티스 주요 구성 요소

#### 1. 쿠버네티스 클러스터 구성
- 컨트롤 플레인(Master) : 클러스터 관리 및 제어
- 노드 : 컨테이너 실행

#### 2. 컨트롤 플레인의 주요 컴포넌트
- API Server
    - 클러스터에 대한 요청 처리
    - etcd와 통신하여 데이터를 저장 및 조회
    - 클라이언트와 클러스터 간의 인터페이스 역할
- Scheduler
    - 새로 생성된 파드를 어떤 노드에 배치할지 결정
    - 노드의 현재 상태와 파드 요구사항을 분석
- etcd
    - key-value 형태로 모든 상태와 데이터를 저장
    - 데이터 일관성 및 고가용성 보장
- Controller Manager
    - 클러스터의 상태를 지속적으로 확인 및 유지
    - 복제 컨트롤러, 노드 컨트롤러 등이 포함

#### 3. Node의 주요 컴포넌트
- Kube Proxy
    - 네트워크 트래픽 라우팅과 부하 분산 역할
    - iptables나 IPVS를 사용해 설정 관리
- Kubelet
    - 노드에서 파드를 실행하고 상태를 모니터링
    - 컨테이너 실행 환경(Container Runtime Interface, CRI) 제공

<br>


### ✏️ 쿠버네티스 실행 과정
![image.png](https://hyobins.github.io/assets/img/k8s3.png)
1. 파드 생성 요청 : 관리자가 API Server에 파드 추가 요청
2. 상태 기록 : API Server가 etcd에 요청 상태 기록
3. 컨트롤러 동작 : Controller가 새 파드 요청을 감지하고 파드 할당 작업 실행
4. 스케줄링 : Scheduler가 파드에 적합한 노드를 선택
5. 파드 실행
    - Kubelet이 파드를 실행
    - 실행 상태를 API Server와 etcd에 기록
6. 지속적 모니터링 : Controller, Scheduler, Kubelet이 클러스터 상태를 지속적으로 확인

<br>


### ✏️ 다른 오케스트레이션 도구와의 비교

#### Docker Swarm
- 사용 및 설정이 비교적 간단하지만 쿠버네티스만큼 강력하지 않음
- 기능이 적고 확장성이 제한적

#### Mesos
- JSON 기반
- 대규모 클러스터 관리에 유리
- 범용 오케스트레이션 도구지만 설정 복잡

#### 쿠버네티스의 강점
- 자동화 수준이 높음
- 복구 및 확장성 지원
- 다양한 기능 제공 (로드 밸런싱, 자동 복구, 스케일링 등)


<br>



### 오늘의 회고
- 오늘은 쿠버네티스의 기본 개념에 대해 딥다이브 하며 복습 하는 시간을 가졌다. 
기존에 헷갈리던 용어나 동작 방식에 대해 정리할 수 있는 시간이었다. 
심화 개념으로 갈 수록 기본 용어와 동작 원리에 대해 헷갈리면 이해가 어려운 부분이 많기 때문에 
한 번 쯤 복습 하는 시간이 필요했는데 이번 기회에 확실히 알고 넘어갈 수 있어 좋았다. 



<br>


#### [참고]
- https://kubernetes.io/ko/docs/concepts/overview/components/
- https://tech.kakaopay.com/post/jack-k8s-internals-part-1/#1-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%9D%98-hub-and-spoke-%ED%8C%A8%ED%84%B4
- https://www.samsungsds.com/kr/insights/220222_kubernetes1.html
- https://velog.io/@hojun8094/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C%EC%97%90%EC%84%9C-%EC%A7%81%EC%A0%91-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EA%B0%9C%EB%B0%9C%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%951
- https://chrisjune-13837.medium.com/infra-kubernetes-vs-swarm-vs-mesos-%EB%B9%84%EA%B5%90-b04b2cd032ab